
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://manoli-iborra.github.io/PowerBI/pag10.html">
      
      <link rel="icon" href="imagenes/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.6">
    
    
      
        <title>7. Más DAX - Power BI</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.802231af.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      

  


  

  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-DSTGE8QTPP"),document.addEventListener("DOMContentLoaded",function(){"undefined"!=typeof location$&&location$.subscribe(function(t){gtag("config","G-DSTGE8QTPP",{page_path:t.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DSTGE8QTPP"></script>


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-blue" data-md-color-accent="deep-orange">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lenguaje-dax" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="index.html" title="Power BI" class="md-header__button md-logo" aria-label="Power BI" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Power BI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              7. Más DAX
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Power BI" class="md-nav__button md-logo" aria-label="Power BI" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    Power BI
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        1. Introducción
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="pag1.html" class="md-nav__link">
        2. Power BI
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="pag2.html" class="md-nav__link">
        3. Power BI Service
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" data-md-state="indeterminate" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        4. Power BI Desktop
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="4. Power BI Desktop" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          4. Power BI Desktop
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="pag7.html" class="md-nav__link">
        4.1. Get Data
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="pag8.html" class="md-nav__link">
        4.2. Data Preparing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="pag9.html" class="md-nav__link">
        4.3. Data Modeling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="pag5.html" class="md-nav__link">
        4.4. Data Visualization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="pag4.html" class="md-nav__link">
        4.5. Data Reporting
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="pag3.html" class="md-nav__link">
        5. Power Query Editor
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="pag6.html" class="md-nav__link">
        6. Mejora de informes
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="pag10.html" class="md-nav__link md-nav__link--active">
        7. Más DAX
      </a>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="lenguaje-dax"><strong>LENGUAJE DAX</strong><a class="headerlink" href="#lenguaje-dax" title="Permanent link">&para;</a></h1>
<p>DAX significa Expresiones de Análisis de Datos. Es un lenguaje de fórmulas que se utiliza en diferentes herramientas de Microsoft y te permite crear medidas, columnas calculadas, tablas calculadas y seguridad a nivel de filas.</p>
<div class="admonition info">
<p class="admonition-title">Aviso</p>
<p>DAX no es sensible a mayúsculas o minúsculas.</p>
</div>
<p>Existe una herramienta gratuita que transforma las fórmulas DAX en código limpio, atractivo y legible.</p>
<p><img alt="imagen" src="imagenes/format.PNG" /></p>
<!--

## **Modelos Relacionales**

### **1. El modelo en estrella**

Consisten en la relación de las tablas de hechos y dimensiones, de forma que la tabla de hechos queda centrada y las dimensiones, se relacionan con la tabla de hechos con un único nivel.


![imagen](imagenes/estrella.PNG)


La tabla de hechos tiene un identificador almacenado para relacionar cada una de las tablas de dimensiones, implicadas en la relación. Cada una de las tablas de dimensiones, tienen un çunico identificador, coincidente con el almacenado en la tabla de hechos.



### **2. El modelo Snowflake**

Es una amplicación del modelo en estrella ya que sigue manteniendo las mismas relaciones, pero se amplia la profundidas de las relaciones, ya que una misma dimensión, puede contener otros identificadores además del que relaciona la tabla de hechos.De forma que se pueda relacionar la tabla de dimensiones con otra u otras tablas de dimensiones, con el fin de aumentar el nivel de detalle de la información almacenada de forma más atomizada.

![imagen](imagenes/snowflake.png)


## **Tipos de relaciones entre tablas**

La cardinalidad es el número de entidades con la cual otra entidad se puede asociar mediante una relación binaria. 

![imagen](imagenes/relaciones.PNG){width=500}


Power BI Desktop facilita la creación de relaciones realizando una detección automática durante la carga, sin embargo, puede que sea posible que estas deban ser modificadas o crear nuevas relaciones no identificadas, por tanto es importante saber crearlas o editarlas.


![imagen](imagenes/relacion2.PNG){width=500}


Para poder editar una relación, nos situamos sobre la línea que une las tablas y con el botón derecho nos aparecen las propiedades.

![imagen](imagenes/Relacion3.PNG){width=500}


![imagen](imagenes/relacion4.PNG){width=500}

Con la opción de **Administrar Relaciones**, nos aparecen las relaciones que tenemos hasta ese momento.

![imagen](imagenes/relacion5.PNG){width=500}


## **Las relaciones y su cardinalidad**

Dentro de la vista de modelo, podemos observar que cada tabla contienen varios elementos que ayudan a gestionar las tablas de forma ágil.

![imagen](imagenes/relacion6.PNG){width=300}

El **ojo** hace referencia a ocultar/mostrar tablas.

Mientras que los tres puntos permiten realizar una serie de acciones:

![imagen](imagenes/relacion7.PNG){width=500}


## **Lenguaje DAX**

DAX es un lenguaje de fórmulas usado en Power BI que significa **Data Analysis Expressions** o **Expresiones de Análisis de Datos**. Las funciones que nos proporciona tienen funcionalidades idénticas y los mismos nombres que las funciones de Excel.

Se utiliza para crear columnas calculadas, medidas y tablas personalizadas.

Existen diferentes tipos de funciones en el lenguaje DAX, que se agrupan de forma que cada uno de estos grupos, tienen unas finalidades específicas en el desarrollo de medidas y columnas calculadas.


![imagen](imagenes/funciones.PNG)

### **Operadores DAX**

El lenguaje DAX (Expresiones de análisis de datos) usa operadores para crear expresiones que comparan valores, realizan cálculos aritméticos o trabajan con cadenas.
Existen cuatro tipos distintos de operadores de cálculo: 

- ***Operadores aritméticos:*** Para realizar operaciones matemáticas básicas (como sumas, restas o multiplicaciones), para combinar números y para producir resultados numéricos.

- ***Operadores de comparación:*** Permite comparar dos valores con los siguientes operadores. Cuando se comparan dos valores con estos operadores, el resultado es un valor lógico, ya sea TRUE o FALSE.

- ***Operadores de concatenación de texto:*** Use el signo "et" ( & ) para unir, o concatenar, dos o más cadenas de texto a fin de generar un único fragmento de texto.

- ***Operadores lógicos:*** Usa los operadores lógicos (&&) y (||) para combinar expresiones para generar un solo resultado.

## **Columnas**


### **Crear columna personalizada**

Hay tres maneras de crear una columna personalizada:

- Directamente en el origen de datos, por ejemplo agregando el campo calculado a una vista en una base de datos relacional.

- Crear la columna personalizada en  Power Query.

- Crear la columna calculada mediante DAX.

### **Crear columna calculada mediante DAX**

Nos situamos en los puntos situados junto a la tabla y nos aparece el siguiente menú:

![imagen](imagenes/columnadax.PNG){width=500}

También desde Herramientas de Tablas:

![imagen](imagenes/columnadax2.PNG){width=500}

## **Medidas**

Las medidas se construyen de forma similar a las columnas calculadas, pero no se puede visualizar desde la vista de datos, por lo que se deberá representar el resultado en un objeto visual con el fin de validar el resultado de la función.

Es un cálculo que también se realiza con una expresión DAX pero no es necesario que este cálulo sea hecho en cada línea.

Las medidas tienen que estar creadas dentro de una tabla, pero luego podemos moverlas a otras tablas.

Se recomienda crear una tabla donde se agruparán todas las medidas calculadas del modelo. 

![imagen](imagenes/dax1.PNG)

### **Medidas Rápidas**

Las Medidas Rápidas, facilitan la creación de funciones, ya que se basan simplemente en definir cual es la medida que se quiere realizar, y cumplimentar los datos de las tablas de las que se
dispone. Con esto, Power BI creará la formula de una manera rápida y sencilla.

![imagen](imagenes/rapida.PNG)

Se puede solicitar la publicación de nuevas medidas rápidas al equipo de soporte de Windows, desde la propia ventana de medidas rápidas. La comunidad técnica de la herramienta es muy activa y escucha a los usuarios, para mejorar la herramienta.

## **Diferencias entre Columnas Calculadas y Medidas**

![imagen](imagenes/modelado.PNG)

Las Columnas Calculadas, se calculan en el momento de definir el cálculo. Esto significa que si se hace uso de forma muy recurrente de este recurso, en tablas con un número elevado de filas, estará ocupando un espacio muy valioso en la memoria del equipo.

Las Columnas calculadas, se actualizan al realizar el cálculo, al abrir el proyecto que contiene dichas funciones, o cuando se hace clic sobre el botón de actualizar de Power BI.

Las medidas tienen un uso más optimizado, aunque un abuso del uso de este recurso, también puede penalizar el rendimiento de la memoria y por tanto generar retrasos en la presentación del dato.

Las medidas solo se cargan cuando la página del cuadro de mando, contiene este elemento en algún objeto visual. Lo que significa, que mientras no se muestre en pantalla un objeto visual con una medida, no afectará al rendimiento.

Evidentemente, como en el caso de las Columnas Calculadas, un uso muy abusivo de este recurso, puede suponer que las vistas de los cuadros de mando contengan muchas medidas y por tanto se retrase su presentación por requerir un alto rendimiento de la máquina que soporta estos paneles.

Como conclusión, se deberá buscar el equilibrio según criterios lógicos, para no usar el recurso de Columnas Calculadas, en el cálculo de datos que no se necesitan tener durante toda la presentación del dato, ni recargar los cuadros de mando con Medidas, que sacrificarán los tiempos de carga de los Dashboards. Por eso, se debe tener un criterio muy fino, a la hora de decidir por que recurso decantarse, partiendo de los objetivos de uso de cada uno.


![imagen](imagenes/columnavsmedida.PNG)

## **Crear un repositorio de Medidas**

1. Crear contenedor desde la función "Especificar Datos".

![imagen](imagenes/repositorio.PNG)

2. Asignar nombre del repositorio.

![imagen](imagenes/repositorio2.PNG)

3. Asignar las medidas al nuevo contenedor.

![imagen](imagenes/repositorio3PNG.PNG)

4. Eliminar la columna que se ha creado por defecto.

![imagen](imagenes/repositorio4.PNG)

## **La función CALCULATE**

CALCULATE es con diferencia la función más potente de DAX y se encarga de evaluar una expresión en un contexto que está modificado por los filtros especificados en la función.
Con CALCULATE comenzarán la mayoría de las fórmulas que diseñemos en los informes.

![imagen](imagenes/calculate.PNG)

Con la función podemos:

- Añadir nuevos filtros o modificar al contexto existente.
- Ignorar una parte o todo el contexto de evaluación.

En la sintaxis de CALCULATE la única parte obligatoria es la expresión, por lo que se puede expresar una función CALCULATE sin ningún filtro y funcionará sin problemas.

![imagen](imagenes/calculate2.PNG)


Los pasos se realizan de la siguiente forma:

![imagen](imagenes/calculate3.PNG)

![imagen](imagenes/calculate4.PNG)


El resultado de la función anterior será:

![imagen](imagenes/calculate5.PNG)


## **Buenas prácticas durante el modelado de datos**

1. Modelar correctamente los datos antes de comenzar a desarrollar cualquier informe. Se recomienda trabajar con modelos en estrella que reducen el tamaño de almacenamiento y optimizan los tiempos de consulta.

2. Se recomienda que el dato venga procesado desde el origen en la medida que sea posible ya que las operaciones de transformación en Power Query pueden repercutir en el rendimiento del informe.

3. Si el modelo de datos cuenta con una variable tipo DATETIME, se recomienda separar las fechas de las horas en Power Query ya que mejora la calidad de comprensión.

4. Eliminar tanto filas como columnas que no se vayan a utilizar.

5. Evitar convertir valores BLANK a valor, por lo tanto es mejor controlar los nulos y los valores en blanco con lenguaje DAX.

6. Crear una tabla de medidas en Power BI Desktop donde ir creando diferentes medidas del modelo con DAX.

7. En Power BI Desktop, ocultar los campos de relación de tablas (campo id) en las tablas del modelo. Esto facilita el trabajo a los usuarios de negocio que vayan a trabajar en un futuro con un informe.

8. Incluir comentarios a las medidas para comprender fácilmente los objetivos de las funciones.

9. No sobrecargar una página de elementos visuales y no sobrecargar un informe con muchas páginas.

10. Evitar el uso de elementos visuales no certificados, para no tener problemas en el desarrollo.

11. El elemento visual matriz, suele tener un tiempo de cómputo mayor que otros. 
-->
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Pie">
      
        
        <a href="pag6.html" class="md-footer__link md-footer__link--prev" aria-label="Anterior: 6. Mejora de informes" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              6. Mejora de informes
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            2022-2023 Manuela Iborra - Licencia CC BY-NC-SA
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="mailto:<m.iborra@edu.gva.es>" target="_blank" rel="noopener" title="" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M400 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM178.117 262.104C87.429 196.287 88.353 196.121 64 177.167V152c0-13.255 10.745-24 24-24h272c13.255 0 24 10.745 24 24v25.167c-24.371 18.969-23.434 19.124-114.117 84.938-10.5 7.655-31.392 26.12-45.883 25.894-14.503.218-35.367-18.227-45.883-25.895zM384 217.775V360c0 13.255-10.745 24-24 24H88c-13.255 0-24-10.745-24-24V217.775c13.958 10.794 33.329 25.236 95.303 70.214 14.162 10.341 37.975 32.145 64.694 32.01 26.887.134 51.037-22.041 64.72-32.025 61.958-44.965 81.325-59.406 95.283-70.199z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": ["header.autohide", "navigation.expand"], "translations": {"clipboard.copy": "Copiar al portapapeles", "clipboard.copied": "Copiado al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}, "search": "assets/javascripts/workers/search.409db549.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.756773cc.min.js"></script>
      
    
  </body>
</html>